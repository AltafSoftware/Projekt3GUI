<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tilføj spillere</title>
    <!-- Link to external CSS file -->
    <link rel="stylesheet" href="tilføjSpiller.css">
    <style>
        
    </style>
</head>

<body>
    <!-- Heading for adding players -->
    <b><h1>INDTAST SPILLERNAVNE</h1></b>
    <br><br>
    <!-- Container for player inputs -->
    <div id="playerContainer">
        <!-- Form for player submission -->
        <form id="spillerForm" action="drukspilSide.html">
            <!-- Container for player inputs -->
            <div id="spillerInput">
                <!-- Label and input field for player 1 -->
                <label for="Spiller1">Spiller 1:</label>
                <input type="text" id="Spiller1" name="Spiller1"><br><br>
                <!-- Label and input field for player 2 -->
                <label for="Spiller2">Spiller 2:</label>
                <input type="text" id="Spiller2" name="Spiller2"><br>
            </div>
            <!-- Container for buttons -->
            <div id="buttons">
                <!-- Button to start the game -->
                <input type="submit" value="Start spil">
                <!-- Button to add more players -->
                <button id="tilføjSpillereKnap" type="button">Tilføj flere spillere</button>
            </div>
        </form>
    </div>
    <div id="leaderboard">
        <div id="leaderboardCanvas">
            <h2>LEADERBOARD</h2>
            <ol id="leaderboardList"></ol>
        </div>
    </div>

    <script>
        // Function to render the leaderboard
        function renderLeaderboard(playerNames) {
            const leaderboardList = document.getElementById('leaderboardList');
            leaderboardList.innerHTML = ''; // Clear existing leaderboard

            // Loop through the player names and create HTML elements for each entry
            playerNames.forEach((name, index) => {
                const listItem = document.createElement('li');
                listItem.textContent = name;
                leaderboardList.appendChild(listItem);
            });
        }

        // Handle form submission
        document.getElementById("spillerForm").addEventListener("submit", function (event) {
            event.preventDefault(); // Prevent default form submission behavior

            // Get player names from input fields
            const playerInputs = document.querySelectorAll("input[name^='Spiller']");
            const playerNames = [];
            playerInputs.forEach(input => {
                playerNames.push(input.value);
            });

            // Render the leaderboard with the new player names
            renderLeaderboard(playerNames);

            // Send player names to backend
            fetch('http://localhost:3001/store-players', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ players: playerNames }),
            })
            .then(response => {
                if (response.ok) {
                    console.log('Player names sent successfully to backend!');
                    // Reset input-box
                    playerInputs.forEach(input => {
                        input.value = '';
                    });
                } else {
                    console.error('Failed to send player names to backend.');
                    // Handle error, show error message, or retry
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });

        // Function to add more player inputs
        function addPlayerInput() {
            // Get the container for player inputs
            var playerInputs = document.getElementById("spillerInput");
            // Calculate the number of the new player based on the current number of children
            var newPlayerNumber = playerInputs.querySelectorAll("input[name^='Spiller']").length + 1;
            // Create a new label element for the new player
            var newLabel = document.createElement("label");
            // Set the text content of the new label
            newLabel.textContent = "Spiller " + newPlayerNumber + ": ";
            // Create a new input element for the new player
            var newInput = document.createElement("input");
            // Set the type of the new input element
            newInput.type = "text";
            // Set the name attribute of the new input element
            newInput.name = "Spiller" + newPlayerNumber;

            // Add line break before the new player label and input
            playerInputs.appendChild(document.createElement("br"));
            // Append the new label to the container
            playerInputs.appendChild(newLabel);
            // Append the new input to the container
            playerInputs.appendChild(newInput);
            // Add line break after the new player label and input
            playerInputs.appendChild(document.createElement("br"));
        }

        // Add event listener for the button to add more players
        document.getElementById("tilføjSpillereKnap").addEventListener("click", addPlayerInput);

        // Call the renderLeaderboard function to initially render the leaderboard
        renderLeaderboard([]);
    </script>
</body>

</html>
